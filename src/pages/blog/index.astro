---
/**
 * Blog Index Page (English) - Premium UI
 * Uses Content Collections for blog data
 */
import BaseLayout from '@layouts/BaseLayout.astro';
import Breadcrumb from '@components/ui/Breadcrumb.astro';
import BlogFilteredGrid from '@components/islands/BlogFilteredGrid';
import BlogSidebar from '@components/blog/BlogSidebar.astro';
import { getArticlesForLocale, getCategories, getPopularArticles } from '@lib/blog-utils';

const locale = 'en';

const breadcrumbs = [
  { name: 'Home', url: '/' },
  { name: 'Blog', url: '/blog' },
];

// Use Content Collections for blog data (no server-side filtering - handled client-side)
const articles = await getArticlesForLocale(locale);
const categories = await getCategories(locale);
const popularPosts = await getPopularArticles(locale, 5);

// Prepare search articles for sidebar
const searchArticles = articles.map((a) => ({
  slug: a.slug,
  title: a.title,
  description: a.description,
  category: a.category,
  readTime: a.readTime,
}));
---

<BaseLayout
  title="Blog | Modern Face Institute | Dr. Robério Brandão"
  description="Technical articles on facial surgery, Modern Face techniques, Endomidface, applied anatomy and continuing medical education. Content for plastic surgeons."
  keywords={[
    'facial surgery blog',
    'Modern Face articles',
    'Endomidface articles',
    'Dr Robério Brandão blog',
  ]}
  lang="en"
>
  <!-- Hero Section - Premium Dark -->
  <section
    class="py-20 bg-gradient-to-b from-primary-900 via-primary-800 to-primary-900 border-b border-primary-700/30"
  >
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <Breadcrumb items={breadcrumbs} class="text-primary-300 mb-8" />

      <div class="max-w-2xl">
        <h1 class="heading-1-white mb-6">Blog</h1>
        <p class="body-large text-primary-200 leading-relaxed">
          Technical articles on facial surgery, Modern Face philosophy, advanced techniques and
          continuing medical education.
        </p>
        <div class="flex flex-wrap gap-6 mt-8">
          <span class="label-eyebrow-white flex items-center gap-2">
            <span class="material-symbols-outlined text-accent-400 text-lg">article</span>
            {articles.length} Articles
          </span>
          <span class="label-eyebrow-white flex items-center gap-2">
            <span class="material-symbols-outlined text-accent-400 text-lg">category</span>
            {categories.length} Categories
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content: Grid + Sidebar -->
  <section class="py-12 md:py-16 bg-ivory">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="flex flex-col lg:flex-row gap-8 lg:gap-12">
        <!-- Main Content - Client-side filtered grid -->
        <main class="flex-1 min-w-0">
          <BlogFilteredGrid
            articles={articles}
            categories={categories}
            showFeatured={true}
            locale="en"
            client:load
          />
        </main>

        <!-- Sidebar -->
        <aside class="w-full lg:w-80 flex-shrink-0">
          <BlogSidebar
            categories={categories}
            popularPosts={popularPosts}
            articles={searchArticles}
            locale="en"
          />
        </aside>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 bg-primary-900">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 text-center">
      <h2 class="heading-2-white mb-4">Learn Directly from Dr. Robério</h2>
      <p class="body-large-light mb-8 max-w-xl mx-auto">
        The articles are just the beginning. Mentorship offers complete learning with live cases and
        personalized follow-up.
      </p>
      <a
        href="/education"
        class="inline-flex items-center gap-2 px-8 py-4
               bg-accent-600 text-white rounded-lg
               text-sm font-medium uppercase tracking-wider
               hover:bg-accent-500 hover:-translate-y-0.5
               transition-all duration-300
               focus:outline-none focus:ring-2 focus:ring-accent-400 focus:ring-offset-2 focus:ring-offset-primary-900"
      >
        View Mentorship Programs
        <span class="material-symbols-outlined" aria-hidden="true">arrow_forward</span>
      </a>
    </div>
  </section>
</BaseLayout>
